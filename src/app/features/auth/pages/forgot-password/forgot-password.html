<div class="auth-layout">
  <app-public-navbar></app-public-navbar>
  <main class="auth-content">
    <div class="auth-container">
      <div class="forgot-password-form-wrapper">
        <h2 class="form-title">Recuperar Contraseña</h2>
        <p class="form-subtitle">
          Ingresa tu email y te enviaremos las instrucciones para restablecer tu contraseña.
        </p>

        @if (success) {
          <div class="form-success-banner" role="alert">
            <i class="fas fa-check-circle"></i>
            <div class="success-content">
              <strong>Se ha enviado un email con instrucciones a {{ submittedEmail }}</strong>
              <p>Por favor, revisa tu bandeja de entrada y carpeta de spam.</p>
              <p class="success-info">El enlace expirará en 15 minutos.</p>
            </div>
          </div>
          <app-button
            type="button"
            variant="primary"
            size="large"
            (clicked)="goToLogin()"
            ariaLabel="Volver a iniciar sesión"
            class="submit-button">
            <i class="fas fa-sign-in-alt" aria-hidden="true"></i>
            Volver a Iniciar Sesión
          </app-button>
        } @else {
          <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" class="forgot-password-form" novalidate>
            @if (errorMessage) {
              <div class="form-error-banner" role="alert">
                <div class="error-content">
                  <p>{{ errorMessage }}</p>
                  @if (errorMessage.includes('no está verificado')) {
                    <app-button
                      type="button"
                      variant="secondary"
                      size="small"
                      (clicked)="goToResendVerification()"
                      ariaLabel="Reenviar email de verificación"
                      class="error-button">
                      <i class="fas fa-paper-plane"></i>
                      Reenviar Email de Verificación
                    </app-button>
                  }
                </div>
              </div>
            }

            <app-input-group
              label="Email"
              labelIcon="fa-envelope"
              type="email"
              placeholder="ejemplo@correo.com"
              id="email"
              name="email"
              [required]="true"
              [errorMessage]="getEmailError()"
              [maxLength]="100"
              autocomplete="email"
              formControlName="email">
            </app-input-group>

            <app-button
              type="submit"
              variant="primary"
              size="large"
              [disabled]="forgotPasswordForm.invalid || isSubmitting"
              [loading]="isSubmitting"
              ariaLabel="Enviar instrucciones"
              [attr.aria-busy]="isSubmitting"
              class="submit-button">
              <i class="fas fa-paper-plane" aria-hidden="true"></i>
              Enviar Instrucciones
            </app-button>

            <p class="form-footer">
              ¿Recordaste tu contraseña?
              <a routerLink="/login" class="form-link">Volver a iniciar sesión</a>
            </p>
          </form>
        }
      </div>
    </div>
  </main>
  <footer class="auth-footer">
    <p class="footer-text">&copy; 2024 TurnFlow. Todos los derechos reservados.</p>
  </footer>
</div>

