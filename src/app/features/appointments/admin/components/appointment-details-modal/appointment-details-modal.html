<app-modal
  [isOpen]="isOpen"
  title="Detalles del Turno"
  [headerClass]="'modal-header-info'"
  [noBorder]="true"
  (close)="onClose()">
  
  @if (appointment) {
    <div class="appointment-details">
      <!-- Información del usuario -->
      <div class="detail-section">
        <h3 class="section-title">Usuario</h3>
        <div class="detail-item">
          <i class="fas fa-user"></i>
          <div class="detail-content">
            <span class="detail-label">Nombre:</span>
            <span class="detail-value">{{ getUserName() }}</span>
          </div>
        </div>
        <div class="detail-item">
          <i class="fas fa-envelope"></i>
          <div class="detail-content">
            <span class="detail-label">Email:</span>
            <span class="detail-value">{{ appointment.userEmail }}</span>
          </div>
        </div>
      </div>

      <!-- Información del turno -->
      <div class="detail-section">
        <h3 class="section-title">Turno</h3>
        <div class="detail-item">
          <i class="fas fa-calendar-alt"></i>
          <div class="detail-content">
            <span class="detail-label">Fecha:</span>
            <span class="detail-value">{{ formatDate(appointment.date) }}</span>
          </div>
        </div>
        <div class="detail-item">
          <i class="fas fa-clock"></i>
          <div class="detail-content">
            <span class="detail-label">Horario:</span>
            <span class="detail-value">{{ appointment.startTime }} - {{ appointment.endTime }}</span>
            <span class="detail-meta">({{ appointment.durationMinutes }} minutos)</span>
          </div>
        </div>
        <div class="detail-item">
          <i class="fas fa-info-circle"></i>
          <div class="detail-content">
            <div class="detail-label-row">
              <span class="detail-label">Estado:</span>
              <span 
                class="state-badge"
                [class]="getStateBadgeClass(appointment.state)">
                {{ getStateLabel(appointment.state) }}
              </span>
            </div>
          </div>
        </div>
        @if (appointment.confirmedAt) {
          <div class="detail-item">
            <i class="fas fa-check-circle"></i>
            <div class="detail-content">
              <span class="detail-label">Confirmado:</span>
              <span class="detail-value">{{ formatDateTime(appointment.confirmedAt) }}</span>
            </div>
          </div>
        }
        @if (appointment.cancelledAt) {
          <div class="detail-item">
            <i class="fas fa-times-circle"></i>
            <div class="detail-content">
              <span class="detail-label">Cancelado:</span>
              <span class="detail-value">{{ formatDateTime(appointment.cancelledAt) }}</span>
            </div>
          </div>
          @if (appointment.cancellationReason) {
            <div class="detail-item">
              <i class="fas fa-comment"></i>
              <div class="detail-content">
                <span class="detail-label">Motivo de cancelación:</span>
                <span class="detail-value">{{ appointment.cancellationReason }}</span>
              </div>
            </div>
          }
        }
        @if (appointment.previousAppointmentId) {
          <div class="detail-item">
            <i class="fas fa-exchange-alt"></i>
            <div class="detail-content">
              <span class="detail-label">Turno anterior:</span>
              <span class="detail-value">ID #{{ appointment.previousAppointmentId }}</span>
            </div>
          </div>
        }
      </div>
    </div>
  }
</app-modal>
